## scope权限说明

更新时间：2024-06-14

1）**report_service**（获取账户报表信息） 需要在授权 URL 的 scope 参数上添加 report_service，进行授权后才能访问获取广告账户报表信息的接口。

2）**ad_query**（获取推广计划、推广单元、推广创意信息） 需要在授权 URL 的 scope 参数上添加 ad_query 进行授权后才能访问查询广告的接口。

3）**ad_manage**（创建&修改推广计划、推广单元、推广创意） 需要在授权 URL 的 scope 参数上添加 ad_manage 进行授权后才能访问搭建广告的接口。

4）**account_manage**（账户管理） 需要在授权 URL 的 scope 参数上添加 account_manage 进行授权后才能访问账户预算、流水、余额等信息的接口。

授权 url
示例：示例如下：[https://ad-market.xiaohongshu.com/auth?appId=3&scope=\[%22report_service%22,%22ad_query%22,%22ad_manage%22,%22account_manage%22\]&redirectUri=http://www.ad.xiaohongshu.com&state=abcd](https://ad-market.xiaohongshu.com/auth?appId=3&scope=["report_service","ad_query","ad_manage","account_manage"]&redirectUri=http://www.ad.xiaohongshu.com&state=abcd"%20\t%20"https://ad-market.xiaohongshu.com/_blank)

## 授权流程

更新时间：2024-08-16

申请开放者时小红书提供的授权链接：https://ad-market.xiaohongshu.com/auth?appId=应用ID&scope=权限范围&redirectUri=回调地址xxx&state=abcd

|             |        |                            |                                                                                                   |
|-------------|--------|----------------------------|---------------------------------------------------------------------------------------------------|
| **参数**      | **描述** | **值(示例)**                  | **备注**                                                                                            |
| appId       | 应用id   | 123                        | 申请应用后小红书返回的app_id                                                                                 |
| scope       | 权限范围   | %5B%22report_service%22%5D | 可在各功能模块文档中获取对应的权限 code，参数值原始格式："report_service","xxxxxxx","……"，使用时需要 UrlEncode 一次"report_service" |
| redirectUri | 回调地址   | http:ad.xiaohongshu.com    | 申请应用时开发者提供的回调地址，使用时需要 UrlEncode 一次                                                                |
| state       | 自定义参数  | abcd                       | 回调时会原样返回，可用于广告主区分不同投放渠道等用途，广告主可选择性使用                                                              |

## 获取Token

更新时间：2025-09-09

利用授权码 auth_code，请求小红书服务器，获取 access_token 和 refresh_token 及当前账户的广告主 ID。

请求地址：https://adapi.xiaohongshu.com/api/open/oauth2/access_token

请求方式：POST

数据格式：JSON

### 请求参数

|           |        |          |                                                                |
|-----------|--------|----------|----------------------------------------------------------------|
| **字段**    | **类型** | **是否必填** | **备注**                                                         |
| app_id    | long   | 是        | 申请应用后小红书返回的 app_id                                             |
| secret    | string | 是        | 申请应用后小红书返回的 secret                                             |
| auth_code | string | 是        | 授权时返回的 auth_code（auth_code有效期十分钟，超时未调用本接口，则auth_code失效，需要重新授权） |

### 返回参数

|                          |          |                                                      |
|--------------------------|----------|------------------------------------------------------|
| **字段**                   | **类型**   | **描述**                                               |
| code                     | int      | 返回码                                                  |
| success                  | boolean  | 是否成功，true:成功                                         |
| msg                      | string   | 返回信息                                                 |
| data                     | struct   |                                                      |
| access_token             | string   | 用于验证权限的 token（有效期一天）                                 |
| access_token_expires_in  | long     | access_token 剩余有效时间，单位：秒                             |
| refresh_token            | string   | 用于获取新的 access_token 和 refresh_token，并且刷新过期时间（有效期一个月） |
| refresh_token_expires_in | long     | refresh_token 剩余有效时间，单位：秒                            |
| user_id                  | string   | 授权账号的user_id                                         |
| app_id                   | long     | 应用ID                                                 |
| approval_role_type       | int      | 授权账号类型，4：品牌，601：代理商                                  |
| role_type                | int      | 应用角色类型，1：品牌开发者，2：代理商开发者，3：服务商开发者，4:技术服务商             |
| platform_type            | int      | 平台类型，1：聚光，2：蒲公英，3:私信三方，4:乘风                          |
| approval_advertisers     | struct[] | 授权广告主账号，品牌/代理商/服务商开发者时有值**（蒲公英应用无该值）**               |
| advertiser_id            | long     | 账号id                                                 |
| advertiser_name          | string   | 账号名称                                                 |
| scope                    | string   | 授权接口范围                                               |
| corporation_name         | string   | 企业名称                                                 |
| virtual_seller_id        | string   | 授权账号 virtual_seller_id                               |
| create_time              | long     | 授权记录创建时间                                             |
| update_time              | long     | 授权记录更新时间                                             |

### 示例

```curl
curl --location 'https://adapi.xiaohongshu.com/api/open/oauth2/access_token' \\

--header 'content-type: application/json'

--data '{

"app_id": 3,

"secret": "1234abc",

"auth_code": "d6a0b18531a2b9599a2c1e2361659c00"

}'
```

返回结果：

```json
{
  "code": 0,
  "success": true,
  "msg": "成功",
  "data": {
    "user_id": "5c8650cb0000000001004367",
    "role_type": 3,
    "approval_advertisers": [
      {
        "advertiser_id": 1234,
        "advertiser_name": "品牌测试账号222"
      }
    ],
    "refresh_token": "5be1789576f45f90ccfbf4ba16ca4a5b",
    "advertiser_id": 1234,
    "refresh_token_expires_in": 2591999,
    "approval_role_type": 4,
    "platform_type": 1,
    "access_token": "0cde2287cd0dedcf472ceb266d0710ba",
    "access_token_expires_in": 86399
  }
}
```

## 刷新Token

更新时间：2025-09-09

请求小红书服务器，刷新 access_token 和 refresh_token 及 token 过期时间。

请求地址： https://adapi.xiaohongshu.com/api/open/oauth2/refresh_token

请求方式：POST

数据格式：JSON

### 请求参数

|               |        |          |                          |
|---------------|--------|----------|--------------------------|
| **字段**        | **类型** | **是否必填** | **备注**                   |
| app_id        | long   | 是        | 申请应用后小红书返回的 app_id       |
| secret        | string | 是        | 申请应用后小红书返回的 secret       |
| refresh_token | string | 是        | 最近一次小红书返回的 refresh_token |

### 返回参数

|                          |          |                                              |
|--------------------------|----------|----------------------------------------------|
| **字段**                   | **类型**   | **描述**                                       |
| code                     | int      | 返回码                                          |
| success                  | boolean  | 是否成功，true:成功                                 |
| msg                      | string   | 返回信息                                         |
| data                     | struct   |                                              |
| access_token             | string   | 用于验证权限的 token                                |
| access_token_expires_in  | long     | access_token 剩余有效时间，单位：秒                     |
| refresh_token            | string   | 用于获取新的 access_token 和 refresh_token，并且刷新过期时间 |
| refresh_token_expires_in | long     | refresh_token 剩余有效时间，单位：秒                    |
| user_id                  | string   | 授权账号的user_id                                 |
| app_id                   | long     | 应用ID                                         |
| approval_role_type       | int      | 授权账号类型，4：品牌，601：代理商                          |
| role_type                | int      | 应用角色类型，1：品牌开发者，2：代理商开发者，3：服务商开发者             |
| platform_type            | int      | 平台类型，1：聚光，2：蒲公英                              |
| approval_advertisers     | struct[] | 授权广告主账号，品牌/代理商/服务商开发者时有值**（蒲公英应用无该值）**       |
| advertiser_id            | long     | 账号id                                         |
| advertiser_name          | string   | 账号名称                                         |
| corporation_name         | string   | 企业名称                                         |
| virtual_seller_id        | string   | 授权授权账号virtual_seller_id                      |
| scope                    | string   | 授权接口范围                                       |
| create_time              | long     | 授权记录创建时间                                     |
| update_time              | long     | 授权记录更新时间                                     |

### 示例

``` curl
curl --location 'https://adapi.xiaohongshu.com/api/open/oauth2/refresh_token' \\

--header 'content-type: application/json' 

--data '{

"app_id": 1,

"secret": "xxsf",

"refresh_token": "18419c9324853d3b22a8580eb9b67b86"

}'
```

返回结果

```json
{
  "code": 0,
  "success": true,
  "msg": "成功",
  "data": {
    "user_id": "5c8650cb0000000001004367",
    "role_type": 3,
    "approval_advertisers": [
      {
        "advertiser_id": 1234,
        "advertiser_name": "品牌测试账号222"
      }
    ],
    "refresh_token": "5be1789576f45f90ccfbf4ba16ca4a5b",
    "advertiser_id": 1234,
    "refresh_token_expires_in": 2591999,
    "approval_role_type": 4,
    "platform_type": 1,
    "access_token": "0cde2287cd0dedcf472ceb266d0710ba",
    "access_token_expires_in": 86399
  }
}
```

## Token有效期&续期

更新时间：2023-11-06

**1. access_token**

access_token 的有效期是 1 天。当 access_token 超时后，可以使用 refresh_token 进行刷新，每次刷新都会产生新的 access_token 和
refresh_token，同时重置二者的有效期，从初始值计起。多次获取token以最后一次token为准，之前的token会在获取新token后5min失效。

**2. refresh_token**

refresh_token 有效期是 30 天。当 refresh_token 失效的后，需要通过"获取 token"，得到全新 access_token 和
refresh_token。刷新后会生成新的 token，老的 access_token 和 refresh_token 将不可再使用，请每次刷新都做好存储。

## 代理商主子账号余额查询

更新时间：2025-09-17

**接口基本信息**

请求域名：https://adapi.xiaohongshu.com

请求接口：/api/open/finance/balance/query

请求方式：POST

数据格式：JSON

**HEADER**

|              |        |       |
|--------------|--------|-------|
| Access-Token | string | token |

**请求参数**

|                        |                    |          |                            |                |
|------------------------|--------------------|----------|----------------------------|----------------|
| **字段**                 | **类型**             | **是否必填** | **说明**                     | **备注**         |
| user_id                | string             | 是        | 代理商主账号ID                   |                |
| virtual_seller_id_list | list&lt;string&gt; | 是        | 子账号ID/代理商vsellerId，最多传100个 | 注意该参数修改为list类型 |

**示例：**

```json
{
  "user_id": "573c5fxxxxxx9681d7bde1f",
  "virtual_seller_id_list": [
    "573c5fxxxxxx6a69681d7bde1f"
  ]
}
```

**返回参数**

|            |        |        |        |
|------------|--------|--------|--------|
| **字段**     | **类型** | **说明** | **备注** |
| code       | int    | 返回码    |        |
| msg        | string | 返回信息   |        |
| success    | bool   | 接口是否成功 |        |
| data       | struct |        |        |
| request_id | string | 请求ID   |        |

**data注意回参修改为list了**

|                     |                    |         |
|---------------------|--------------------|---------|
| **字段**              | **类型**             | **说明**  |
| total               | int64              | 总条数     |
| wallet_balance_list | list&lt;struct&gt; | 分账户余额信息 |

**wallet_balance_list**

|                         |                    |                              |                                     |
|-------------------------|--------------------|------------------------------|-------------------------------------|
| **字段**                  | **类型**             | **说明**                       | **备注**                              |
| virtual_seller_id       | string             | 子账号ID/代理商vsellerId           |                                     |
| total_available_balance | string             | 总可用余额，单位元，保留两位小数             |                                     |
| total_frozen_balance    | string             | 总冻结余额，单位元，保留两位小数             |                                     |
| total_balance           | string             | 总余额（冻结+可用）                   |                                     |
| balance_list            | list&lt;struct&gt; | 分资金类型的余额明细                   |                                     |
| account_status          | int32              | 钱包账户状态，正常：OPEN=1，冻结：FROZEN=2 | 注意：钱包账户状态和账号状态是独立的状态，能否转账只受钱包账户状态影响 |

**balance_list**

|                   |        |                                                                            |        |
|-------------------|--------|----------------------------------------------------------------------------|--------|
| **字段**            | **类型** | **说明**                                                                     | **备注** |
| virtual_seller_id | string | 子账号ID/代理商vsellerId                                                         |        |
| wallet_type       | int32  | 资金类型  <br>0; // 现金  <br>1; // 授信  <br>2; // 返货  <br>3; // 券  <br>4; //赔付返货 |        |
| available_balance | string | 可用余额，单位元，保留两位小数                                                            |        |
| frozen_balance    | string | 冻结余额，单位元，保留两位小数                                                            |        |
| total_balance     | string | 总余额（冻结+可用）                                                                 |        |

**示例：**

```json

{
  "data": {
    "wallet_balance_list": [
      {
        "balance_list": [
          {
            "wallet_type": 0,
            "available_balance": "11000.11",
            "frozen_balance": "0.00",
            "total_balance": "11000.11",
            "virtual_seller_id": "67d3f00475f2150015028a68"
          },
          {
            "total_balance": "0.00",
            "virtual_seller_id": "67d3f00475f2150015028a68",
            "wallet_type": 4,
            "available_balance": "0.00",
            "frozen_balance": "0.00"
          },
          {
            "wallet_type": 3,
            "available_balance": "0.00",
            "frozen_balance": "0.00",
            "total_balance": "0.00",
            "virtual_seller_id": "67d3f00475f2150015028a68"
          },
          {
            "wallet_type": 1,
            "available_balance": "0.00",
            "frozen_balance": "0.00",
            "total_balance": "0.00",
            "virtual_seller_id": "67d3f00475f2150015028a68"
          },
          {
            "total_balance": "0.00",
            "virtual_seller_id": "67d3f00475f2150015028a68",
            "wallet_type": 2,
            "available_balance": "0.00",
            "frozen_balance": "0.00"
          }
        ],
        "account_status": 1,
        "virtual_seller_id": "67d3f00475f2150015028a68",
        "total_available_balance": "11000.11",
        "total_frozen_balance": "0.00",
        "total_balance": "11000.11"
      }
    ]
  },
  "code": 0,
  "success": true,
  "msg": "成功"
}

```